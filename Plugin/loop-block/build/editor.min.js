!function(e,t){var n=e.element.createElement,o=e.blocks.registerBlockType,a=e.apiFetch,l=(e.blockEditor.RichText,e.blockEditor.BlockControls,e.blockEditor.InnerBlocks),i=(e.blockEditor.AlignmentToolbar,e.blockEditor.MediaUpload),r=e.blockEditor.InspectorControls,s=e.serverSideRender,u=e.components.TextControl,p=e.components.Button,d=e.components.SelectControl,c=e.components.RangeControl,b=e.components.ToggleControl,m=e.components.RadioControl,y=(e.components.CheckboxControl,e.components.TextareaControl),g=e.components.FormTokenField,f=(e.components.Autocomplete,e.components.DatePicker),v=e.components.Dropdown,h=e.components.Placeholder,C=e.components.PanelBody,k=e.blockEditor.useBlockProps,A=e.element.useState,_=e.i18n.__;o("block/loop",{title:_("Loop"),description:_("An advanced block that allows displaying posts, taxonomies and users based on different query parameters and visual configurations."),icon:"text",category:"common",supports:{align:["wide","full"],default:""},attributes:{title:{type:"string",default:""},subtitle:{type:"string",default:""},linkText:{type:"string",default:""},link:{type:"string",default:""},adTitle:{type:"string"},adSubtitle:{type:"string"},adImage:{type:"string"},adLink:{type:"string"},adSponsor:{type:"string"},adOrder:{type:"string"},type:{type:"string",default:""},taxonomy:{type:"string",default:""},ids:{type:"array",default:[]},taxQuery:{type:"array",default:[]},metaQuery:{type:"array",default:[]},date:{type:"object",default:{type:"",before:"2025-01-01",after:"2022-01-01",beforeNum:"1",beforeUnit:"days ago",afterNum:"7",afterUnit:"days ago"}},query:{type:"string"},orderby:{type:"string",default:""},order:{type:"string"},template:{type:"string"},slider:{type:"boolean"},sliderOption:{type:"string"},sliderArrows:{type:"boolean",default:!0},sliderDots:{type:"boolean"},sliderAutoplay:{type:"boolean"},sliderLoop:{type:"boolean"},cols:{type:"number"},rows:{type:"number"},gap:{type:"number"},pages:{type:"number",default:5},pager:{type:"string",default:""},ratio:{type:"number",default:1},filter:{type:"array",default:[]},empty:{type:"boolean"},emptyContent:{type:"string"},debug:{type:"boolean"}},edit:function(o){var l=o.attributes,k=e.hooks.applyFilters("hook_orderby",[{label:"No order",value:"none"},{label:"ID",value:"ID"},{label:"Title",value:"title"},{label:"Author",value:"author"},{label:"Published date",value:"date"},{label:"Modified date",value:"modified"},{label:"By parent",value:"parent"},{label:"Random order",value:"rand"},{label:"Comment count",value:"comment_count"},{label:"Menu order",value:"menu_order"},{label:"Meta value",value:"meta_value"},{label:"Numeric meta value",value:"meta_value_num"},{label:"By include order",value:"post__in"}]);const[T,N]=A([]),[x,D]=A([]),[P,w]=A([]);return[n(r,{key:"inspector"},n(C,{title:_("General"),className:"block-display",initialOpen:!0},n(d,{label:_("Type"),options:loop.types,value:l.type,onChange:function(e){o.setAttributes({type:e})}}),"taxonomy"==l.type&&n(d,{label:_("Taxonomies"),options:loop.taxonomies,value:l.taxonomy,onChange:function(e){o.setAttributes({taxonomy:e})}}),n(d,{label:_("Template"),options:loop.templates,value:l.template,onChange:function(e){o.setAttributes({template:e})}}),"user"!==l.type&&"taxonomy"!==l.type&&n(d,{label:_("Order by"),options:k,value:l.orderby,onChange:function(e){o.setAttributes({orderby:e})}}),"user"==l.type&&n(d,{label:_("Order by"),options:[{label:"No order",value:"none"},{label:"ID",value:"ID"},{label:"Display Name",value:"display_name"},{label:"Name",value:"user_name"},{label:"Login",value:"user_login"},{label:"Nicename",value:"user_nicename"},{label:"Email",value:"user_email"},{label:"URL",value:"user_url"},{label:"Registered",value:"user_registered"},{label:"Post count",value:"post_count"},{label:"Include",value:"include"},{label:"Meta value",value:"meta_value"},{label:"Numeric meta value",value:"meta_value_num"}],value:l.orderby,onChange:function(e){o.setAttributes({orderby:e})}}),"taxonomy"==l.type&&n(d,{label:_("Order by"),options:[{label:"No order",value:"none"},{label:"Name",value:"name"},{label:"Count",value:"count"}],value:l.orderby,onChange:function(e){o.setAttributes({orderby:e})}}),n(d,{label:_("Order"),options:[{label:"Descending",value:"DESC"},{label:"Ascending",value:"ASC"}],value:l.order,onChange:function(e){o.setAttributes({order:e})}}),n(b,{label:_("Debug"),checked:l.debug,onChange:function(e){o.setAttributes({debug:e})}})),n(C,{title:_("Query"),initialOpen:!1},n("div",{},n(g,{label:_("IDs in"),value:l.ids,suggestions:T,onChange:function(e){o.setAttributes({ids:e})},saveTransform:function(e){return e.split(":")[0]},onInputChange:function(e){if(!(e.length<2||/^https?:/.test(e))){var t="?search="+encodeURIComponent(e)+"&type="+l.type;a({path:"/loop/ids"+t}).then((function(e){N(e)}))}}})),"user"!==l.type&&"taxonomy"!==l.type&&n("div",{},n(g,{label:_("Taxonomies (taxonomy:term:operator)"),value:l.taxQuery,suggestions:x,onChange:function(e){o.setAttributes({taxQuery:e})},onInputChange:function(e){if(!(e.length<2||/^https?:/.test(e))){var t="?search="+encodeURIComponent(e)+"&type="+l.type;a({path:"/loop/terms"+t}).then((function(e){D(e)}))}}})),"taxonomy"!==l.type&&n("div",{},n(g,{label:_("Meta (key:value:compare:type)"),value:l.metaQuery,onChange:function(e){o.setAttributes({metaQuery:e})}})),"taxonomy"!==l.type&&n(m,{label:_("Date"),options:[{label:_("Anytime"),value:"0"},{label:_("Specific"),value:"1"},{label:_("Relative"),value:"2"}],selected:l.date.type,onChange:function(e){var t=lodash.cloneDeep(l.date);t.type=e,o.setAttributes({date:t})}}),"1"==l.date.type&&n("div",{className:"components-panel__row components-loop-date"},n(v,{position:"bottom right",renderToggle:function(e){e.isOpen;var t=e.onToggle;return n("div",{onClick:t},n("label",{},_("From")),n(p,{isLink:!0},l.date.after))},renderContent:function(e){return n(f,{currentDate:l.date.after,onChange:function(e){var t=lodash.cloneDeep(l.date);t.after=moment(e).format("YYYY-MM-DD"),o.setAttributes({date:t})}})}}),n(v,{position:"bottom right",renderToggle:function(e){e.isOpen;var t=e.onToggle;return n("div",{onClick:t},n("label",{},_("To")),n(p,{isLink:!0},l.date.before))},renderContent:function(e){return n(f,{currentDate:l.date.before,onChange:function(e){var t=lodash.cloneDeep(l.date);t.before=moment(e).format("YYYY-MM-DD"),o.setAttributes({date:t})}})}})),"2"==l.date.type&&n("div",{className:"components-panel__row components-loop-date"},n(v,{position:"bottom right",contentClassName:"components-loop-date-popup",renderToggle:function(e){e.isOpen;var t=e.onToggle;return n("div",{onClick:t},n("label",{},_("From")),n(p,{isLink:!0},l.date.afterNum+" "+l.date.afterUnit))},renderContent:function(e){return n("div",{className:"components-loop-date-dialog"},n(u,{type:"number",value:l.date.afterNum,onChange:function(e){var t=lodash.cloneDeep(l.date);t.afterNum=e,o.setAttributes({date:t})}}),n(d,{options:[{label:"Days",value:"days ago"},{label:"Weeks",value:"weeks ago"},{label:"Months",value:"months ago"},{label:"Years",value:"years ago"}],value:l.date.afterUnit,onChange:function(e){var t=lodash.cloneDeep(l.date);t.afterUnit=e,o.setAttributes({date:t})}}),n("span",{},_("ago")))}}),n(v,{position:"bottom right",contentClassName:"components-loop-date-popup",renderToggle:function(e){e.isOpen;var t=e.onToggle;return n("div",{onClick:t},n("label",{},_("To")),n(p,{isLink:!0},l.date.beforeNum+" "+l.date.beforeUnit))},renderContent:function(e){return n("div",{className:"components-loop-date-dialog"},n(u,{type:"number",value:l.date.beforeNum,onChange:function(e){var t=lodash.cloneDeep(l.date);t.beforeNum=e,o.setAttributes({date:t})}}),n(d,{options:[{label:"Days",value:"days ago"},{label:"Weeks",value:"weeks ago"},{label:"Months",value:"months ago"},{label:"Years",value:"years ago"}],value:l.date.beforeUnit,onChange:function(e){var t=lodash.cloneDeep(l.date);t.beforeUnit=e,o.setAttributes({date:t})}}),n("span",{},_("ago")))}})),n(u,{label:_("Query arguments"),value:l.query,rows:1,help:_("eg: post_type=any. See WP_Query, WP_User_Query and WP_Term_Query"),onChange:function(e){o.setAttributes({query:e})}})),n(C,{title:_("Title & Link"),className:"block-display",initialOpen:!1},n(u,{label:_("Title"),value:l.title,onChange:function(e){o.setAttributes({title:e})}}),n(u,{label:_("Subtitle"),value:l.subtitle,onChange:function(e){o.setAttributes({subtitle:e})}}),n(u,{label:_("Link Text"),value:l.linkText,onChange:function(e){o.setAttributes({linkText:e})}}),n(u,{label:_("Link URL"),value:l.link,placeholder:"http://",onChange:function(e){o.setAttributes({link:e})}})),n(C,{title:_("Display"),className:"block-display",initialOpen:!1},n(c,{label:_("Columns"),value:l.cols,min:1,max:12,onChange:function(e){o.setAttributes({cols:e})}}),n(c,{label:_("Rows"),value:l.rows,min:1,max:12,onChange:function(e){o.setAttributes({rows:e})}}),n(c,{label:_("Gap"),value:l.gap,min:0,max:100,onChange:function(e){o.setAttributes({gap:e})}}),n(c,{label:_("Thumbnail ratio"),value:l.ratio,min:0,max:3,step:.01,onChange:function(e){o.setAttributes({ratio:e})}}),n(c,{label:_("Post per page"),value:l.pages,onChange:function(e){o.setAttributes({pages:e})}}),n(d,{label:_("Pager"),options:[{label:"None",value:""},{label:"Pagination",value:"pagination"},{label:"Load More",value:"more"},{label:"Scroll",value:"scroll"}],value:l.pager,onChange:function(e){o.setAttributes({pager:e})}}),n(b,{label:_("Enable slider"),checked:l.slider,onChange:function(e){o.setAttributes({slider:e})}}),l.slider&&n("div",{className:""},n(b,{label:_("Prev/Next arrows"),checked:l.sliderArrows,onChange:function(e){o.setAttributes({sliderArrows:e})}}),n(b,{label:_("Show dot indicators"),checked:l.sliderDots,onChange:function(e){o.setAttributes({sliderDots:e})}}),n(b,{label:_("Enable autoplay"),checked:l.sliderAutoplay,onChange:function(e){o.setAttributes({sliderAutoplay:e})}}),n(b,{label:_("Loop slider"),checked:l.sliderLoop,onChange:function(e){o.setAttributes({sliderLoop:e})}}),n("p")),n(b,{label:_("Show empty"),checked:l.empty,onChange:function(e){o.setAttributes({empty:e})}}),l.empty&&n(y,{label:_("Empty content"),value:l.emptyContent,onChange:function(e){o.setAttributes({emptyContent:e})}})),n(C,{title:_("Filter"),className:"block-display",initialOpen:!1},n(g,{label:_("filter::value[name]"),value:l.filter,suggestions:P,className:"components-form-token-filter",onChange:function(e){o.setAttributes({filter:e})},onInputChange:function(e){if(!(e.length<2||/^https?:/.test(e))){var t="?search="+encodeURIComponent(e)+"&type="+l.type;a({path:"/loop/filter"+t}).then((function(e){w(e)}))}},onFocus:function(e){var n=t(".components-form-token-filter .components-flex");n.sortable({items:"> div",update:function(e,a){var l=n.find("> div").map((function(){return t.trim(t(this).find("> span > span > span:last").text())})).get();o.setAttributes({filter:l})}})}}),n("p",{className:"components-base-control__help"},_("Enter 3 or more characters"))),n(C,{title:_("AD"),className:"block-display",initialOpen:!1},n(u,{label:_("Image"),placeholder:_("Enter, upload, choose from Media Library"),value:l.adImage,onChange:function(e){o.setAttributes({adImage:e})}}),n(i,{allowedTypes:"image/jpeg,image/png,image/webp,image/gif,video/mp4,video/quicktime",onSelect:function(e){return o.setAttributes({adImage:e.url})},render:function(e){return n("div",{style:{display:"inline-flex",margin:"-1.5rem 0 1rem 0"}},n(p,{icon:"upload",label:_("Upload"),onClick:e.open}),n(p,{icon:"no-alt",label:_("Clear"),onClick:function(){o.setAttributes({adImage:""})}}))}}),n(u,{label:_("Title"),value:l.adTitle,onChange:function(e){o.setAttributes({adTitle:e})}}),n(u,{label:_("Subtitle"),value:l.adSubtitle,onChange:function(e){o.setAttributes({adSubtitle:e})}}),n(u,{label:_("Sponsor"),value:l.adSponsor,onChange:function(e){o.setAttributes({adSponsor:e})}}),n(u,{label:_("Link URL"),value:l.adLink,placeholder:"http://",onChange:function(e){o.setAttributes({adLink:e})}}),n(u,{label:_("Order"),value:l.adOrder,type:"number",onChange:function(e){o.setAttributes({adOrder:e})}}))),""==l.type?n(h,{icon:"text",label:_("Loop")},n("div",{},_("Display Post/User items in loop.")),n(d,{label:_("Choose loop type to start"),options:loop.types,className:"components-select-loop-type",value:l.type,onChange:function(e){o.setAttributes({type:e})}})):n(s,{block:"block/loop",attributes:l})]},save:function(e){return null}}),o("block/permission",{title:_("Block Permission"),description:_("Display Gutenberg content blocks depending on their attributes."),icon:"shield",category:"common",attributes:{display:{type:"string",default:""},displayPermission:{type:"string",default:""},userRoles:{type:"array",default:[]},phpFunc:{type:"string",default:""}},edit:function(e){var t=k(),o=e.attributes;return[n("div",t,n(l),n("div",{className:"block-permission__help"},"Add your content and set the permission parameters.")),n(r,{key:"inspector"},n(C,{title:_("Permissions"),className:"block-display",initialOpen:!0},n(d,{label:_("Choose the block permission"),options:[{label:"Show",value:""},{label:"Hide",value:"hide"}],value:o.display,onChange:function(t){e.setAttributes({display:t})}}),n(d,{label:_("The content for"),options:[{label:"Everyone",value:""},{label:"Users",value:"users"},{label:"User Roles",value:"user_roles"},{label:"PHP function",value:"php_func"}],value:o.displayPermission,onChange:function(t){e.setAttributes({displayPermission:t})}}),"user_roles"==o.displayPermission&&n(g,{label:_("User roles"),value:o.userRoles,suggestions:loop.user_roles,onChange:function(t){e.setAttributes({userRoles:t})}}),"php_func"==o.displayPermission&&n(u,{label:_("PHP function name"),value:o.phpFunc,onChange:function(t){e.setAttributes({phpFunc:t})}})))]},save:function(e){var t=k.save();return n("div",t,n(l.Content))}})}(window.wp,jQuery);