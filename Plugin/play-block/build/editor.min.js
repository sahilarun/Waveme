!function(e){var t=e.element.createElement,o=e.plugins.registerPlugin,a=e.apiFetch,n=e.editPost.PluginSidebar,l=e.editPost.PluginSidebarMoreMenuItem,i=(e.blockEditor.RichText,e.blockEditor.BlockControls,e.blockEditor.MediaUpload),r=e.components.Button,d=(e.components.FormFileUpload,e.components.TextControl),c=e.components.SelectControl,s=(e.components.RangeControl,e.components.ToggleControl),p=e.components.RadioControl,u=e.components.TextareaControl,m=e.components.FormTokenField,f=(e.components.Autocomplete,e.components.Placeholder,e.components.TabPanel,e.components.PanelBody),h=(e.components.Draggable,e.data.withSelect),b=e.data.withDispatch,g=e.compose.compose,v=e.element.useState,y=e.i18n.__,C=new Waveform,P=g(b((function(e,t){return{setMetaValue:function(o){if(void 0!==t.field){var a={};"duration"==t.field&&(o=C.timeToMS(o)),a[t.field]=o,e("core/editor").editPost({meta:a})}}}})),h((function(e,t){var o=e("core/editor").getEditedPostAttribute("meta")[t.field];return"duration"==t.field&&(o=C.msToTime(o)),{metaValue:o}})))((function(e){var o=e.control||d;switch(o){case s:e.checked=e.metaValue;break;case p:e.selected=e.metaValue;break;default:e.value=e.metaValue}return e.onChange=function(t){e.setMetaValue(t),e.onChanged&&e.onChanged(t)},e.control=null,t("div",{className:"components-meta-control components-"+e.field+"-control "+(e.hide&&""==e.metaValue?"components-form-hidden-empty ":" "),style:e.style},e.before&&e.before(e),t(o,e),e.after&&e.after(e))}));o("play-sidebar",{icon:t("svg",{width:20,height:20}),render:function(){var o={label:"",src:""},p=[];const[h,b]=v([]);if(play&&play.types)for(var g in play.types)p.push({label:g,value:play.types[g]});return[,t(l,{target:"play-sidebar"},y("Play")),t(n,{name:"play-sidebar",title:y("Play"),icon:t("svg",{width:20,height:20,viewBox:"0 0 24 24"},t("path",{d:"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}))},t(f,{title:y("General"),initialOpen:!0},t(P,{label:y("Type"),control:c,field:"type",options:p,after:function(o){return"single"==o.metaValue||"shot"==o.metaValue||"ep"==o.metaValue||""==o.metaValue?t("div",{},t(P,{label:y("Stream"),placeholder:"Enter, upload, choose from Media Library",field:"stream",before:function(o){var a=o.metaValue,n=e.data.select("core/editor").getCurrentPostAttribute("meta").stream_url;return""!==n&&(a=n),t("audio",{style:{margin:"1em 0"},controls:" ",preload:"none",src:a})},after:function(o){return t(i,{onSelect:function(t){return t.fileLength&&e.data.dispatch("core/editor").editPost({meta:{duration:C.timeToMS(t.fileLength)}}),t.meta&&t.meta.bpm&&e.data.dispatch("core/editor").editPost({meta:{bpm:t.meta.bpm}}),o.setMetaValue(t.url)},type:"image",render:function(a){return t("div",{style:{display:"inline-flex",padding:"0 0 10px 0"}},t(r,{icon:"upload",label:y("Upload"),onClick:a.open}),t(r,{icon:"cloud",label:y("Attempt to retrieve data from remote server"),onClick:function(t){var a=o.metaValue,n=t.currentTarget;""==a||n.disabled||(n.disabled=!0,playImport(a,{},(function(t){n.disabled=!1,function(t){for(var o in t)if(t.hasOwnProperty(o)&&null!==t[o]&&""!==t[o]&&"0"!==t[o]){if("waveform_data"==o&&!Array.isArray(t[o]))break;var a={};if(a[o]=t[o],e.data.dispatch("core/editor").editPost({meta:a}),"title"==o&&e.data.dispatch("core/editor").editPost({title:t[o]}),"description"==o&&""!=o){var n=t[o].split("\n").map((function(t){return e.blocks.createBlock("core/paragraph",{content:t})}));e.data.dispatch("core/editor").insertBlocks(n)}if("blob"==o){var l=e.data.select("core/editor").getCurrentPostAttribute("id"),i=new FormData;i.append("id",l),i.append("image",t[o]),i.append("action","play_upload_image"),fetch(ajaxurl,{method:"POST",body:i}).then((function(t){t.error?e.data.dispatch("core/notices").createNotice("error",t.error):e.data.dispatch("core/editor").editPost({featured_media:t.featured_media})}))}}"string"==typeof t&&e.data.dispatch("core/editor").editPost({meta:{stream_url:t}})}(t)})))}}),t(r,{icon:"chart-bar",label:y("Generate Waveform"),onClick:function(){var t=o.metaValue,a=event.currentTarget;""!=t&&(a.disabled=!0,C.loadAudioData(t,(function(t){var o=Math.round(1e3*t.duration),n={waveform_data:t.data,duration:o,bpm:t.bpm};e.data.dispatch("core/editor").editPost({meta:n}),a.disabled=!1})))}}),t(r,{icon:"no-alt",label:y("Clear"),onClick:function(){o.setMetaValue("")}}))}})}}),t(P,{label:y("Stream URL"),field:"stream_url",hide:!0}),t(P,{label:y("Duration"),field:"duration"}),t(P,{label:y("BPM"),field:"bpm"}),t(P,{label:y("Waveform"),field:"waveform_data",hide:!0})):t("div",{},t(P,{control:m,suggestions:h,className:"components-form-token-post",field:"items",onFocus:function(t){if("undefined"!=typeof sortable){var o=sortable(".components-form-token-post .components-flex",{items:":not(input)"})[0];o&&o.addEventListener("sortupdate",(function(t){var o=t.detail.newEndList.map((function(e){return e.innerText.split(":")[0]}));e.data.dispatch("core/editor").editPost({meta:{post:o.join(",")}})}))}},onChanged:function(t){var o=t.map((function(e){return e.split(":")[0]}));e.data.dispatch("core/editor").editPost({meta:{post:o.join(",")}})},onInputChange:function(e){if(!(e.length<2||/^https?:/.test(e))){var t="?type="+o.metaValue+"&search="+encodeURIComponent(e);a({path:"/play/play/items"+t}).then((function(e){b(e)}))}}}),t("p",{className:"components-base-control__help"},y("Please enter 3 or more characters to search single stations")),t(P,{control:s,label:y("Auto type"),field:"auto_type"}),t("p",{className:"components-base-control__help"},y("Build the list from Loop Block in content")))}})),t(f,{title:y("Captions"),initialOpen:!1},t(P,{control:m,className:"components-form-token-post components-form-hidden-help",field:"captions",label:"",help:"",after:function(e){return t("div",{id:"components-form-caption"},t(d,{label:y("Add caption"),placeholder:y("Label e.g. English"),onChange:function(e){o.label=e}}),t("div",{style:{display:"inline-flex"}},t(d,{placeholder:y("WebVTT file"),onChange:function(e){o.src=e}}),t(i,{onSelect:function(e){var t=document.getElementById("components-form-caption").getElementsByTagName("input");o.src=e.url,t[1].value=e.url},render:function(e){return t(r,{text:y("Upload"),className:"is-medium",onClick:e.open})}})),t(r,{text:y("Add"),className:"is-medium",onClick:function(){if(""!==o.label&&""!==o.src){var t=lodash.cloneDeep(e.metaValue);t.push(o.label+":"+o.src),e.setMetaValue(t);var a=document.getElementById("components-form-caption").getElementsByTagName("input");a[0].value=a[1].value=o.label=o.src=""}}}))}})),t(f,{title:y("Download"),initialOpen:!1},t(P,{control:s,label:y("Downloadable"),field:"downloadable",after:function(e){return e.metaValue&&t(P,{placeholder:"Enter, upload, choose from Media Library",field:"download_url",after:function(e){return t(i,{onSelect:function(t){return e.setMetaValue(t.url)},render:function(o){return t("div",{style:{display:"inline-flex"}},t(r,{icon:"upload",label:y("Upload"),onClick:o.open}),t(r,{icon:"no-alt",label:y("Clear"),onClick:function(){e.setMetaValue("")}}))}})}})}})),t(f,{title:y("Purchase"),initialOpen:!1},t(P,{label:y("Title"),field:"purchase_title"}),t(P,{label:y("Link"),placeholder:"http://",field:"purchase_url"})),t(f,{title:y("Stats"),initialOpen:!1},t(P,{label:y("Plays"),field:"post-count-all"}),t(P,{label:y("Likes"),field:"like_count"}),t(P,{label:y("Downloads"),field:"download_count"})),t(f,{title:y("Editor Note"),initialOpen:!1},t(P,{field:"editor_note",control:u})),t(f,{title:y("Copyright"),initialOpen:!1},t(P,{field:"copyright",control:u})))]}})}(window.wp);